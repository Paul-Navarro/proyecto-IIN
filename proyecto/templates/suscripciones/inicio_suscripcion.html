<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suscripciones</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/inicio_suscripcion.css' %}">
</head>
<body>
    <header>
        <div><a class="boton_atras" href="{% url 'home' %}">Atras</a></div>
        <div><h2 class="titulo">Suscripciones</h2></div>
        <div></div>
    </header>

    <main>
        {% if user.is_authenticated %}
            <!-- Si el usuario est치 autenticado, mostrar la bienvenida y las suscripciones -->
            <div class="mensaje_inicio">
                <h2 class="titulo_mensaje">游 Bienvenido a tu secci칩n de Suscripciones 游</h2>
                <p>Aqu칤 podr치s explorar y gestionar tus suscripciones a nuestras categor칤as. 춰Descubre contenido exclusivo y personalizado!</p>
            </div>

            <!-- Suscripciones Actuales -->
            <section class="contenedor_suscripciones">
                <div class="columna_suscripciones">
                    <h3>Suscripciones Actuales</h3>
                    <ul>
                        {% for categoria in categorias_suscritas %}
                            <li>{{ categoria.nombre }}</li>
                        {% empty %}
                            <li>No est치s suscrito a ninguna categor칤a a칰n.</li>
                        {% endfor %}
                    </ul>
                </div>

                <!-- Categor칤as Disponibles para Suscripci칩n -->
                <div class="columna_categorias">
                    <h3>Categor칤as Disponibles</h3>
                    <form method="POST" action="{% url 'comprar_suscripcion' %}">
                        {% csrf_token %}
                        <ul>
                            {% for categoria in categorias_no_suscritas %}
                                <li>
                                    <input type="checkbox" name="categorias" value="{{ categoria.id }}">
                                    {{ categoria.nombre }}
                                </li>
                            {% empty %}
                                <li>No hay m치s categor칤as disponibles para suscripci칩n.</li>
                            {% endfor %}
                        </ul>
                        <div class="contenedor-boton">
                            <button type="submit" class="boton_pago">Suscribirse</button>
                        </div>
                    </form>
                </div>
            </section>
        {% else %}
            <!-- Si el usuario no est치 autenticado, mostrar los botones de login y registro -->
            <div class="mensaje_no_auth">
                <h2 class="titulo_noinicio">No has iniciado sesi칩n</h2>
                <p>Por favor, inicia sesi칩n o reg칤strate para acceder a tus suscripciones.</p>
                <button class="boton_estilo" onclick="redirigirRegistro()" type="button">Sign up</button>
                <button class="boton_estilo" onclick="redirigirLogin()" type="button">Log in</button>
            </div>
        {% endif %}
    </main>

    <!-- Script para redirigir a la pagina de login/register-->
    <script type="text/javascript">
        const redirigirLogin = () => {
            window.location.href = "{% url 'account_login' %}";
        }

        const redirigirRegistro = () => {
            window.location.href = "{% url 'account_signup' %}";
        }
    </script>
</body>
</html>
